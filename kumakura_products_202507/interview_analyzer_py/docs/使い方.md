# 面談分析ツール 利用ガイド

## 概要
このツールは、ExcelまたはCSV形式の面談データファイルを読み込み、AIが内容を要約・アドバイスを生成し、従業員ごとに個別のCSVファイルとして出力します。日報データについても同様に分析し、危険信号の判定も行います。さらに、生成された要約データをもとにAIに質問応答を行うことも可能です。

---

## 必要なファイル
このツールを実行するには、以下の2つのファイルが同じフォルダにある必要があります。

1.  `interview_analyzer_gui.exe` （プログラム本体）
2.  `config.ini` （設定ファイル）

---

## 1. 事前準備：AIバックエンドの設定

このツールは、Google Gemini API またはローカルで動作するOllamaのどちらかをAIバックエンドとして利用できます。

### 1.1. `config.ini` の設定

1.  `config.ini` ファイルをメモ帳などのテキストエディタで開きます。
2.  `[ai_backend]` セクションの `ai_backend = gemini` または `ai_backend = ollama` を選択します。

    ```ini
    [ai_backend]
    ai_backend = gemini  # または ollama
    ```

3.  選択したAIバックエンドに応じて、以下の設定を行います。

### 1.2. Google Gemini API を使用する場合

*   `[gemini]` セクションの `api_key = YOUR_API_KEY` と書かれている部分を、ご自身の有効なGemini APIキーに書き換えます。
*   **オプション**: `model_version` を設定することで、使用するGeminiモデルのバージョンを指定できます。デフォルトは `gemini-2.0-flash` です。

    ```ini
    [gemini]
    api_key = YOUR_API_KEY  # ご自身のGemini APIキーを設定
    model_version = gemini-1.5-flash # 例: gemini-1.5-flash
    ```

### 1.3. Ollama を使用する場合

Ollamaは、ローカルPCで大規模言語モデル（LLM）を実行するためのツールです。インターネット接続なしでAIを利用でき、プライバシー面でも優れています。

#### 1.3.1. Ollama のインストール

1.  Ollamaの公式サイトにアクセスします: [https://ollama.com/](https://ollama.com/)
2.  お使いのOS（Windows, macOS, Linux）に合ったインストーラーをダウンロードし、指示に従ってインストールします。

#### 1.3.2. モデルのダウンロード

Ollamaをインストールしたら、利用したいLLMモデルをダウンロードします。例えば、`llama3` モデルをダウンロードするには、コマンドプロンプトまたはターミナルで以下のコマンドを実行します。

```bash
ollama run llama3
```

初回実行時にモデルが自動的にダウンロードされます。他のモデル（例: `mistral`, `gemma`）も同様にダウンロードできます。

#### 1.3.3. `config.ini` の設定

*   `[ollama]` セクションの `ollama_url` と `ollama_model` を設定します。
    *   `ollama_url`: 通常は `http://localhost:11434` です。
    *   `ollama_model`: ダウンロードしたモデル名（例: `llama3`）を設定します。

    ```ini
    [ollama]
    ollama_url = http://localhost:11434
    ollama_model = llama3  # ダウンロードしたモデル名を設定
    ```

---

## 2. 実行方法

1.  `interview_analyzer_gui.exe` をダブルクリックして実行します。
2.  GUIアプリケーションが起動し、画面上で操作を行います。

### モード1: 新しい面談ファイルを分析して要約を作成する

1.  GUI上で「面談分析」ラジオボタンを選択します。
2.  「分析対象のファイルまたはフォルダのパス」入力欄に、分析したいExcelまたはCSVファイルのパスを入力します。
    *   **ファイル選択**: 「ファイル選択」ボタンをクリックしてファイルを選択します。
    *   **フォルダ選択**: 「フォルダ選択」ボタンをクリックしてフォルダを選択します。
    *   **ドラッグ＆ドロップ**: ファイルやフォルダを直接入力欄にドラッグ＆ドロップすることも可能です。
    *   **複数のファイルがある場合**: 複数の面談データファイル（CSV/Excel）が格納されている**フォルダのパス**を指定することも可能です。その場合、フォルダ内のすべての対応ファイルが個別に処理されます。
3.  「分析実行」ボタンをクリックします。
4.  AIによる要約・アドバイス生成処理が完了するまで、しばらく待ちます。処理状況はログ表示エリアに表示されます。

### モード2: 既存の要約データを使ってAIと対話する (チャット形式)

1.  GUI上で「AI対話」ラジオボタンを選択します。
2.  「AI対話開始」ボタンをクリックすると、**ローカルのSQLiteデータベースに保存された**既存の面談要約データと日報分析データが読み込まれ、AI対話セッションの準備が開始されます。準備状況はログ表示エリアに表示されます。
3.  準備が完了すると、ログ表示エリアの下に質問入力フィールドと「送信」ボタンが表示されます。
4.  質問入力フィールドにAIへの質問を入力し、「送信」ボタンをクリックします。
5.  AIが**面談要約結果**フォルダと**日報分析結果**フォルダ内のすべてのデータを基に回答を生成し、ログ表示エリアに会話履歴として追記されます。
6.  連続して質問を入力し、AIと対話できます。
7.  AI対話セッションを終了したい場合は、「対話終了」ボタンをクリックします。UIが通常のモードに戻ります。

### モード3: 日報データを分析する

1.  GUI上で「日報分析」ラジオボタンを選択します。
2.  「分析対象のファイルまたはフォルダのパス」入力欄に、分析したい日報Excelファイルのパスを入力します。
    *   **ファイル選択**: 「ファイル選択」ボタンをクリックしてファイルを選択します。
    *   **ドラッグ＆ドロップ**: ファイルを直接入力欄にドラッグ＆ドロップすることも可能です。
3.  「分析実行」ボタンをクリックします。
4.  `config.ini` で設定された期間（週ごとまたは月ごと）で日報が自動的に集計・分析されます。処理状況はログ表示エリアに表示されます。
5.  AIによる要約、アドバイス、危険信号の判定処理が完了するまで、しばらく待ちます。

**日報データの想定される列名:**
*   `タイムスタンプ` (日付、形式: `YYYY/MM/DD HH:MM:SS`)
*   `今日の体調`
*   `今日の気分`
*   `今日の業務内容`
*   `業務での課題や悩み`
*   `その他、共有事項`

---

## 3. 出力結果の確認

モード1の要約・アドバイス生成処理が正常に完了すると、`interview_analyzer_gui.exe` と同じ階層に `面談要約結果` というフォルダが自動で作成されます。

モード3の日報分析処理が正常に完了すると、`interview_analyzer_gui.exe` と同じ階層に `日報分析結果` というフォルダが自動で作成されます。

これらのフォルダの中に、従業員ごとの分析結果（例: `山田太郎_要約データ.csv`、`鈴木花子_20240101-20240107_日報分析.csv`）が保存されています。

**※元のデータファイルが上書きされたり、変更されたりすることは一切ありません。**

---

## 4. Git管理について

本プロジェクトでは、配布物である`interview_analyzer_gui.exe`のみをGitの追跡対象としています。
`dist`フォルダ内の他のファイルや、ビルド時に生成される一時ファイル、ログファイル、データベースファイル、分析結果出力フォルダなどはGitの追跡対象外です。
